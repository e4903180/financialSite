{"ast":null,"code":"import _slicedToArray from \"/home/cosbi/financialSite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/cosbi/financialSite/frontend/src/component/navbar/navbar.js\";\nimport axios from 'axios';\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { Nav, Navbar, Container, NavDropdown } from 'react-bootstrap';\nimport { useNavigate } from 'react-router-dom';\nimport { rootApiIP, WSContext } from '../../constant';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport { FiDatabase } from \"react-icons/fi\";\nimport { AiOutlineTool } from \"react-icons/ai\";\nimport NotificationsNoneOutlinedIcon from '@mui/icons-material/NotificationsNoneOutlined';\nimport NavbarNotifyComp from './navbarNotifyComp';\nimport Badge from '@mui/material/Badge';\nimport \"./navbar.css\";\nimport { AppBar } from '@mui/material';\n\nfunction NavbarComp() {\n  var date = new Date();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      show = _useState2[0],\n      setShow = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      badgeNumber = _useState4[0],\n      setBadgeNumber = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      superUser = _useState8[0],\n      setSuperUser = _useState8[1];\n\n  var _useState9 = useState(date.toLocaleTimeString('en-US')),\n      _useState10 = _slicedToArray(_useState9, 2),\n      time = _useState10[0],\n      setTime = _useState10[1];\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  };\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var nav = useNavigate();\n  var socket = useContext(WSContext);\n  var HandleNotifyQuantity = useCallback(function (arg) {\n    setBadgeNumber(arg);\n  }, []);\n  var HandleTime = useCallback(function (arg) {\n    setTime(arg);\n  }, []);\n\n  function logout(e) {\n    e.preventDefault();\n    axios.get(rootApiIP + \"/user/logout\").then(function (res) {\n      socket.disconnect();\n      nav(\"/login\");\n    }).catch(function (res) {\n      if (res.response.data === \"Session expired\") window.location.reload();\n      alert(\"something error, please try again\");\n    });\n  }\n\n  useEffect(function () {\n    axios.get(rootApiIP + \"/data/get_notify_quantity\").then(function (res) {\n      setBadgeNumber(res.data);\n      setLoading(false);\n    }).catch(function (res) {\n      if (res.response.data === \"Session expired\") window.location.reload();\n    });\n    axios.get(rootApiIP + \"/data/superUser\").then(function (res) {\n      setSuperUser(res.data[0][\"superUser\"]);\n    }).catch(function (res) {\n      if (res.response.data === \"Session expired\") window.location.reload();\n    });\n  }, []);\n  useEffect(function () {\n    if (socket) {\n      socket.on(\"REGISTER_NOTIFY_QUANTITY\", function (arg) {\n        return HandleNotifyQuantity(arg);\n      });\n      socket.on(\"REGISTER_REAL_TIME\", function (arg) {\n        return HandleTime(arg);\n      });\n      return function () {\n        socket.off(\"REGISTER_NOTIFY_QUANTITY\");\n        socket.off(\"REGISTER_REAL_TIME\");\n      };\n    }\n  }, [socket]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Modal, {\n    show: show,\n    onHide: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 21\n    }\n  }, \"Log out\")), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, \"Do you want to log out?\"), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }\n  }, \"No\"), /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    onClick: logout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 21\n    }\n  }, \"Yes\"))), /*#__PURE__*/React.createElement(AppBar, {\n    position: \"sticky\",\n    enableColorOnDark: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h6\",\n    color: \"inherit\",\n    component: \"div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, \"Photos\")));\n}\n\nexport default NavbarComp;","map":{"version":3,"sources":["/home/cosbi/financialSite/frontend/src/component/navbar/navbar.js"],"names":["axios","React","useCallback","useContext","useEffect","useState","Nav","Navbar","Container","NavDropdown","useNavigate","rootApiIP","WSContext","Button","Modal","FiDatabase","AiOutlineTool","NotificationsNoneOutlinedIcon","NavbarNotifyComp","Badge","AppBar","NavbarComp","date","Date","show","setShow","badgeNumber","setBadgeNumber","loading","setLoading","superUser","setSuperUser","toLocaleTimeString","time","setTime","handleClose","handleShow","nav","socket","HandleNotifyQuantity","arg","HandleTime","logout","e","preventDefault","get","then","res","disconnect","catch","response","data","window","location","reload","alert","on","off"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { Nav, Navbar, Container, NavDropdown } from 'react-bootstrap';\nimport { useNavigate } from 'react-router-dom';\nimport { rootApiIP, WSContext } from '../../constant'\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport { FiDatabase } from \"react-icons/fi\";\nimport { AiOutlineTool } from \"react-icons/ai\";\nimport NotificationsNoneOutlinedIcon from '@mui/icons-material/NotificationsNoneOutlined';\nimport NavbarNotifyComp from './navbarNotifyComp';\nimport Badge from '@mui/material/Badge';\nimport \"./navbar.css\";\nimport { AppBar } from '@mui/material';\n\nfunction NavbarComp() {\n    let date = new Date()\n    const [show, setShow] = useState(false);\n    const [badgeNumber, setBadgeNumber] = useState(0)\n    const [loading, setLoading] = useState(true)\n    const [superUser, setSuperUser] = useState(0)\n    const [time, setTime] = useState(date.toLocaleTimeString('en-US'))\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n    const nav = useNavigate()\n    const socket = useContext(WSContext);\n\n    const HandleNotifyQuantity = useCallback((arg) => {\n        setBadgeNumber(arg)\n    }, [])\n\n    const HandleTime = useCallback((arg) => {\n        setTime(arg)\n    }, [])\n\n    function logout(e){\n        e.preventDefault()\n\n        axios.get(rootApiIP + \"/user/logout\")\n            .then(res => {\n                socket.disconnect()\n                nav(\"/login\")\n            }).catch(res => {\n                if(res.response.data === \"Session expired\") window.location.reload()\n                alert(\"something error, please try again\")\n        })\n    }\n\n    useEffect(() => {\n        axios.get(rootApiIP + \"/data/get_notify_quantity\")\n        .then((res) => {\n            setBadgeNumber(res.data)\n            setLoading(false)\n        })\n        .catch((res) => {\n            if(res.response.data === \"Session expired\") window.location.reload()\n        })\n\n        axios.get(rootApiIP + \"/data/superUser\")\n        .then((res) => {\n            setSuperUser(res.data[0][\"superUser\"])\n        })\n        .catch((res) => {\n            if(res.response.data === \"Session expired\") window.location.reload()\n        })\n    }, [])\n\n    useEffect(() => {\n        if(socket){\n            socket.on(\"REGISTER_NOTIFY_QUANTITY\", (arg) => HandleNotifyQuantity(arg));\n            socket.on(\"REGISTER_REAL_TIME\", (arg) => HandleTime(arg));\n\n            return () => {\n                socket.off(\"REGISTER_NOTIFY_QUANTITY\");\n                socket.off(\"REGISTER_REAL_TIME\");\n            };\n        }\n    }, [socket])\n\n    return (\n        <>\n            <Modal show = { show } onHide = { handleClose }>\n                <Modal.Header>\n                    <Modal.Title>Log out</Modal.Title>\n                </Modal.Header>\n\n                <Modal.Body>Do you want to log out?</Modal.Body>\n\n                <Modal.Footer>\n                    <Button variant=\"secondary\" onClick = { handleClose }>\n                        No\n                    </Button>\n\n                    <Button variant = \"primary\" onClick = { logout }>\n                        Yes\n                    </Button>\n                </Modal.Footer>\n            </Modal>\n\n            {/* <Navbar bg = \"dark\" variant = \"dark\" expand = \"lg\" fixed = 'top'>\n                <Container fluid>\n                    <Navbar.Brand href = \"/home\">Financial</Navbar.Brand>\n                    <Navbar.Toggle aria-controls = \"basic-navbar-nav\" />\n                    <Navbar.Collapse id =\" basic-navbar-nav\">\n                        <Nav className = \"ms-auto\">\n                            <p className = \"my-auto\" style = {{color : \"white\"}}>{time}</p>\n\n                            <NavDropdown title = {\n                                <>\n                                    <FiDatabase />\n                                    &emsp;資料庫相關功能\n                                </>\n                            } align = \"end\">\n                                <NavDropdown.Item href = \"/database\">資料庫查詢</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/post_board\">個股推薦</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/line_memo\">Line memo</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/calendar\">法說會行事曆</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/meeting_data\">Meeting data</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/industry_analysis\">產業分析上傳</NavDropdown.Item>\n                                { superUser === 1 && <NavDropdown.Item href = \"/self_upload\">個股研究報告上傳</NavDropdown.Item> }\n                            </NavDropdown>\n                            \n                            <Nav.Link href=\"/tool_nav\">\n                                <>\n                                    <AiOutlineTool />\n                                    &emsp;分析工具\n                                </>\n                            </Nav.Link>\n\n                            <Nav.Link href=\"/subscibe_list\">警示訂閱</Nav.Link>\n                            <Nav.Link href=\"/choose_ticker\">選股</Nav.Link>\n\n                            <NavDropdown id = \"notify\" title = {\n                                <>\n                                    { loading ? \n                                        <Badge color = \"success\">\n                                            <NotificationsNoneOutlinedIcon />\n                                        </Badge>\n                                        :\n                                        <Badge badgeContent = { badgeNumber } invisible = { badgeNumber === \"0\" ? true : false } color = \"success\">\n                                            <NotificationsNoneOutlinedIcon />\n                                        </Badge>\n                                    } \n                                </>\n                            } align = \"end\">\n                                <NavbarNotifyComp />\n                            </NavDropdown>\n\n                            <NavDropdown title = \"更多\" align = \"end\">\n                                <NavDropdown.Item href = \"/Line\">加入Line</NavDropdown.Item>\n                                <NavDropdown.Item href = \"/userList\">成員檔案</NavDropdown.Item>\n                                <NavDropdown.Item onClick = { handleShow }>登出</NavDropdown.Item>\n                            </NavDropdown>\n                        </Nav>\n                    </Navbar.Collapse>\n                </Container>\n            </Navbar> */}\n\n            <AppBar position = 'sticky' enableColorOnDark = { true }>\n                <Typography variant=\"h6\" color=\"inherit\" component=\"div\">\n                    Photos\n                </Typography>\n            </AppBar>\n        </>\n    );\n}\n\nexport default NavbarComp;"]},"metadata":{},"sourceType":"module"}