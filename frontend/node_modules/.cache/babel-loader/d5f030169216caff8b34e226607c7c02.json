{"ast":null,"code":"import _slicedToArray from \"/home/cosbi/financialSite/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/cosbi/financialSite/frontend/src/component/PER_RiverPage/PER_RiverComp.js\";\nimport { Backdrop, CircularProgress } from '@mui/material';\nimport React, { useState } from 'react';\nimport { Typeahead } from 'react-bootstrap-typeahead';\nimport PerRiverComp from './PerRiverComp';\nimport { PerRiverExplain, PerRiverInit } from './PER_River_Init';\nimport { rootApiIP } from '../../constant';\nimport { AutoCom } from '../../autoCom';\nimport axios from 'axios';\nimport HighchartBarComp from '../highchart/highchartBarComp';\nimport HighchartStockComp from '../highchart/highchatStockComp';\n\nfunction PERRiverComp() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      stockNum = _useState2[0],\n      setStockNum = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      inputError = _useState6[0],\n      setInputError = _useState6[1];\n\n  var _useState7 = useState(PerRiverInit),\n      _useState8 = _slicedToArray(_useState7, 2),\n      content = _useState8[0],\n      setContent = _useState8[1];\n\n  var _useState9 = useState([0, 0, 0]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      label = _useState10[0],\n      setLabel = _useState10[1];\n\n  var optionsBarChart = {\n    chart: {\n      type: 'bar',\n      height: 300\n    },\n    title: {\n      text: '本益比河流圖結果'\n    },\n    accessibility: {\n      enabled: false\n    },\n    xAxis: {\n      categories: ['本益比河流圖']\n    },\n    yAxis: {\n      title: {\n        text: '價格區間'\n      }\n    },\n    plotOptions: {\n      series: {\n        stacking: 'normal'\n      }\n    },\n    tooltip: {\n      formatter: function formatter() {\n        if (this.point.hasOwnProperty(\"stackY\") && this.color === \"red\" && this.point.stackY !== this.y) {\n          var offset = this.point.stackY - this.y;\n          return this.series.name + ': <b>' + offset.toFixed(2) + '以上</b>';\n        }\n\n        if (this.point.hasOwnProperty(\"stackY\") && this.color !== \"black\") {\n          var _offset = this.point.stackY - this.y;\n\n          return this.series.name + ': From <b>' + _offset.toFixed(2) + '</b> to <b>' + this.point.stackY.toFixed(2) + '</b>';\n        } else if (!this.point.hasOwnProperty(\"stackY\") && this.color !== \"black\") {\n          return \"<b>資料尚未載入</b>\";\n        } else {\n          return this.series.name + \"<b>: </b>\" + this.y.toFixed(2);\n        }\n      }\n    },\n    series: [{\n      name: '昂貴價區間',\n      data: content[\"up_expensive\"],\n      color: \"red\"\n    }, {\n      name: '合理到昂貴價區間',\n      data: content[\"reasonable_expensive\"],\n      color: \"#FF5353\"\n    }, {\n      name: '便宜到合理價區間',\n      data: content[\"cheap_reasonable\"],\n      color: \"#59FF59\"\n    }, {\n      name: '便宜價區間',\n      data: content[\"down_cheap\"],\n      color: \"#FFFF4F\"\n    }, {\n      name: '最新價格',\n      type: \"line\",\n      data: [content[\"NewPrice\"]],\n      color: \"black\",\n      lineWidth: 4\n    }]\n  };\n\n  var _useState11 = useState({\n    xAxis: {\n      type: \"datetime\",\n      labels: {\n        format: '{value:%Y-%m}'\n      }\n    },\n    chart: {\n      height: 600\n    },\n    accessibility: {\n      enabled: false\n    },\n    series: [],\n    stockTools: {\n      gui: {\n        buttons: ['indicators', 'separator', 'simpleShapes', 'lines', 'crookedLines', 'measure', 'advanced', 'toggleAnnotations', 'separator', 'verticalLabels', 'flags', 'separator', 'zoomChange', 'fullScreen', 'typeChange', 'separator', 'currentPriceIndicator', 'saveChart']\n      }\n    }\n  }),\n      _useState12 = _slicedToArray(_useState11, 2),\n      optionsStockChart = _useState12[0],\n      setOptionsStockChart = _useState12[1];\n\n  var autocom = AutoCom.AutoComList;\n\n  function submit(e) {\n    e.preventDefault();\n    setLoading(true);\n\n    if (autocom.map(function (element) {\n      return element.stock_num_name;\n    }).includes(document.getElementsByClassName('rbt-input-main form-control rbt-input')[0].value) === true) {\n      setInputError(false);\n      axios.post(rootApiIP + \"/data/PER_River\", {\n        \"stockNum\": stockNum[0][\"stock_num_name\"].slice(0, 4)\n      }).then(function (res) {\n        setContent(res.data);\n        setLabel([res.data[\"PER_rate\"][0], res.data[\"PER_rate\"][2], res.data[\"PER_rate\"][4]]);\n        setOptionsStockChart({\n          series: [{\n            type: 'candlestick',\n            name: 'Kline',\n            id: 'Kline',\n            data: res.data[\"Kline\"]\n          }, {\n            name: res.data[\"PER_rate\"][0],\n            data: res.data[\"data1\"]\n          }, {\n            name: res.data[\"PER_rate\"][1],\n            data: res.data[\"data2\"]\n          }, {\n            name: res.data[\"PER_rate\"][2],\n            data: res.data[\"data3\"]\n          }, {\n            name: res.data[\"PER_rate\"][3],\n            data: res.data[\"data4\"]\n          }, {\n            name: res.data[\"PER_rate\"][4],\n            data: res.data[\"data5\"]\n          }]\n        });\n        setLoading(false);\n      }).catch(function (res) {\n        if (res.response.data === \"Session expired\") window.location.reload();\n        setLoading(false);\n      });\n    } else {\n      setInputError(true);\n      setLoading(false);\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Backdrop, {\n    sx: {\n      color: '#fff',\n      zIndex: function zIndex(theme) {\n        return theme.zIndex.drawer + 1;\n      }\n    },\n    open: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }\n  }, \"\\u8CC7\\u6599\\u8F09\\u5165\\u4E2D\\u2003\", /*#__PURE__*/React.createElement(CircularProgress, {\n    color: \"inherit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mx-auto py-3\",\n    style: {\n      width: \"50vw\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"display-6 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, \"\\u672C\\u76CA\\u6BD4\\u6CB3\\u6D41\\u5716\"), /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: submit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"form-group row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"stockNum_or_Name\",\n    className: \"col-md-3 col-form-label text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 25\n    }\n  }, \"\\u80A1\\u7968\\u4EE3\\u865F&\\u540D\\u7A31:\\u2003\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Typeahead, {\n    id: \"stockNum_or_Name\",\n    labelKey: \"stock_num_name\",\n    onChange: setStockNum,\n    options: autocom,\n    placeholder: \"\\u8ACB\\u8F38\\u5165\\u80A1\\u7968\\u4EE3\\u865F\\u6216\\u540D\\u7A31\",\n    selected: stockNum,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 29\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-5 text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary\",\n    style: {\n      width: \"100px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 29\n    }\n  }, \"\\u641C\\u5C0B\")))), inputError ? /*#__PURE__*/React.createElement(\"p\", {\n    className: \"text-center\",\n    style: {\n      color: \"red\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 32\n    }\n  }, \"\\u80A1\\u7968\\u4EE3\\u865F&\\u540D\\u7A31\\u683C\\u5F0F\\u932F\\u8AA4\") : /*#__PURE__*/React.createElement(React.Fragment, null)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mx-auto py-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-8 mx-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    className: \"card-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 29\n    }\n  }, \"\\u6700\\u65B0\\u50F9\\u683C: \", content[\"NewPrice\"]))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mx-auto py-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-8 mx-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(HighchartBarComp, {\n    options: optionsBarChart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(HighchartStockComp, {\n    options: optionsStockChart,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row mx-auto py-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-8 mx-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(PerRiverComp, {\n    pricingName: \"\\u672C\\u76CA\\u6BD4\\u6CB3\\u6D41\\u5716\",\n    options: optionsStockChart,\n    pricingExplain: PerRiverExplain,\n    content: content,\n    cardKey: \"PER_river\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 21\n    }\n  }))));\n}\n\nexport default PERRiverComp;","map":{"version":3,"sources":["/home/cosbi/financialSite/frontend/src/component/PER_RiverPage/PER_RiverComp.js"],"names":["Backdrop","CircularProgress","React","useState","Typeahead","PerRiverComp","PerRiverExplain","PerRiverInit","rootApiIP","AutoCom","axios","HighchartBarComp","HighchartStockComp","PERRiverComp","stockNum","setStockNum","loading","setLoading","inputError","setInputError","content","setContent","label","setLabel","optionsBarChart","chart","type","height","title","text","accessibility","enabled","xAxis","categories","yAxis","plotOptions","series","stacking","tooltip","formatter","point","hasOwnProperty","color","stackY","y","offset","name","toFixed","data","lineWidth","labels","format","stockTools","gui","buttons","optionsStockChart","setOptionsStockChart","autocom","AutoComList","submit","e","preventDefault","map","element","stock_num_name","includes","document","getElementsByClassName","value","post","slice","then","res","id","catch","response","window","location","reload","zIndex","theme","drawer","width"],"mappings":"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","sourcesContent":["import { Backdrop, CircularProgress } from '@mui/material';\nimport React, { useState } from 'react';\nimport { Typeahead } from 'react-bootstrap-typeahead';\nimport PerRiverComp from './PerRiverComp';\nimport { PerRiverExplain, PerRiverInit } from './PER_River_Init';\nimport { rootApiIP } from '../../constant'\nimport { AutoCom } from '../../autoCom';\nimport axios from 'axios';\nimport HighchartBarComp from '../highchart/highchartBarComp';\nimport HighchartStockComp from '../highchart/highchatStockComp';\n\nfunction PERRiverComp() {\n    const [stockNum, setStockNum] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [inputError, setInputError] = useState(false);\n    const [content, setContent] = useState(PerRiverInit);\n    const [label, setLabel] = useState([0, 0, 0])\n\n    const optionsBarChart = {\n        chart: {\n            type: 'bar',\n            height : 300\n        },\n        title: {\n            text: '本益比河流圖結果'\n        },\n        accessibility: {\n            enabled: false\n        },\n        xAxis: {\n            categories: ['本益比河流圖']\n        },\n        yAxis: {\n            title: {\n                text: '價格區間'\n            }\n        },\n        plotOptions: {\n            series: {\n                stacking: 'normal',\n            },\n        },\n        tooltip: {\n            formatter: function() {\n                if(this.point.hasOwnProperty(\"stackY\") && this.color === \"red\" && this.point.stackY !== this.y){\n                    let offset = this.point.stackY - this.y\n                    return this.series.name + ': <b>'+ offset.toFixed(2) + '以上</b>';\n                }\n\n                if(this.point.hasOwnProperty(\"stackY\") && this.color !== \"black\"){\n                    let offset = this.point.stackY - this.y\n                    return this.series.name + ': From <b>'+ offset.toFixed(2) + '</b> to <b>' + this.point.stackY.toFixed(2) + '</b>';\n                }else if(!this.point.hasOwnProperty(\"stackY\") && this.color !== \"black\"){\n                    return \"<b>資料尚未載入</b>\";\n                }else{\n                    return this.series.name + \"<b>: </b>\" + this.y.toFixed(2);\n                }\n            }\n        },\n        series: [\n            {\n                name: '昂貴價區間',\n                data: content[\"up_expensive\"],\n                color: \"red\",\n            },\n            {\n                name: '合理到昂貴價區間',\n                data: content[\"reasonable_expensive\"],\n                color: \"#FF5353\",\n            },\n            {\n                name: '便宜到合理價區間',\n                data: content[\"cheap_reasonable\"],\n                color: \"#59FF59\"\n            },\n            {\n                name: '便宜價區間',\n                data: content[\"down_cheap\"],\n                color: \"#FFFF4F\"\n            },\n            {\n                name: '最新價格',\n                type: \"line\",\n                data: [content[\"NewPrice\"]],\n                color: \"black\",\n                lineWidth : 4\n            }\n        ]\n    }\n\n    const [optionsStockChart, setOptionsStockChart] = useState({\n        xAxis: {\n            type : \"datetime\",\n            labels : {\n                format : '{value:%Y-%m}'\n            }\n        },\n        chart : {\n            height : 600\n        },\n        accessibility: {\n            enabled : false\n        },\n        series: [],\n        stockTools : {\n            gui : {\n                buttons : [ 'indicators', 'separator', 'simpleShapes', 'lines', 'crookedLines', 'measure', 'advanced',\n                'toggleAnnotations', 'separator', 'verticalLabels', 'flags', 'separator', 'zoomChange', 'fullScreen',\n                'typeChange', 'separator', 'currentPriceIndicator', 'saveChart' ]\n            }\n        }\n    });\n\n    const autocom = AutoCom.AutoComList;\n\n    function submit(e){\n        e.preventDefault();\n        setLoading(true);\n\n        if((autocom.map(element => element.stock_num_name).includes(document.getElementsByClassName('rbt-input-main form-control rbt-input')[0].value) === true)){\n            setInputError(false)\n\n            axios.post(rootApiIP + \"/data/PER_River\", {\n                \"stockNum\" : stockNum[0][\"stock_num_name\"].slice(0, 4),\n            })\n            .then(res => {\n                setContent(res.data)\n                setLabel([res.data[\"PER_rate\"][0], res.data[\"PER_rate\"][2], res.data[\"PER_rate\"][4]])\n                \n                setOptionsStockChart({\n                    series : [\n                        {\n                            type : 'candlestick',\n                            name : 'Kline',\n                            id : 'Kline',\n                            data : res.data[\"Kline\"],\n                        },\n                        {\n                            name : res.data[\"PER_rate\"][0],\n                            data : res.data[\"data1\"]\n                        },\n                        {\n                            name : res.data[\"PER_rate\"][1],\n                            data : res.data[\"data2\"]\n                        },\n                        {\n                            name : res.data[\"PER_rate\"][2],\n                            data : res.data[\"data3\"]\n                        },\n                        {\n                            name : res.data[\"PER_rate\"][3],\n                            data : res.data[\"data4\"]\n                        },\n                        {\n                            name : res.data[\"PER_rate\"][4],\n                            data : res.data[\"data5\"]\n                        }\n                    ]\n                })\n                setLoading(false)\n            }).catch(res => {\n                if(res.response.data === \"Session expired\") window.location.reload()\n                setLoading(false)\n            })\n        }else{\n            setInputError(true)\n            setLoading(false)\n        }\n    }\n\n    return (\n        <>\n            <Backdrop\n                sx = {{ color: '#fff', zIndex: (theme) => theme.zIndex.drawer + 1 }}\n                open = { loading }\n            >\n                資料載入中&emsp;\n                <CircularProgress color = \"inherit\" />\n            </Backdrop>\n\n            <div className = 'row mx-auto py-3' style = {{ width : \"50vw\" }}>\n                <h3 className = \"display-6 text-center\">本益比河流圖</h3>\n                \n                <form onSubmit = { submit }>\n                    <div className = 'form-group row'>\n                        <label htmlFor = \"stockNum_or_Name\" className = \"col-md-3 col-form-label text-center\">股票代號&名稱:&emsp;</label>\n                        <div className = 'col-md-3'>\n                            <Typeahead\n                                id = \"stockNum_or_Name\"\n                                labelKey = \"stock_num_name\"\n                                onChange = { setStockNum }\n                                options = { autocom }\n                                placeholder = \"請輸入股票代號或名稱\"\n                                selected = { stockNum }\n                            />\n                        </div>\n\n                        <div className = 'col-md-5 text-center'>\n                            <button type = \"submit\" className = \"btn btn-primary\" style = {{ width : \"100px\" }}>搜尋</button>\n                        </div>\n                    </div>\n                </form>\n                { inputError ? <p className = 'text-center' style = {{ color : \"red\" }}>股票代號&名稱格式錯誤</p> : <></> }\n            </div>\n\n            <div className = 'row mx-auto py-3'>\n                <div className = 'col-md-8 mx-auto'>\n                    <div className = 'card'>\n                        <div className = 'card-body'>\n                            <h3 className = 'card-title'>最新價格: { content[\"NewPrice\"] }</h3>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className = 'row mx-auto py-3'>\n                <div className = 'col-md-8 mx-auto'>\n                    <HighchartBarComp options = { optionsBarChart }/>\n                    <HighchartStockComp options = { optionsStockChart } />\n                </div>\n            </div>\n            \n            <div className = 'row mx-auto py-3'>\n                <div className = 'col-md-8 mx-auto'>\n                    <PerRiverComp\n                        pricingName = \"本益比河流圖\"\n                        options = { optionsStockChart }\n                        pricingExplain = { PerRiverExplain }\n                        content = { content }\n                        cardKey = \"PER_river\"\n                    />\n                </div>\n            </div>\n        </>\n    );\n}\n\nexport default PERRiverComp;"]},"metadata":{},"sourceType":"module"}